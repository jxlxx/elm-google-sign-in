<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Webpack App</title>
    <script type="text/javascript" src="elm.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
  </head>
  <body>
    <div id="g_id_onload"
       data-client_id="789723491626-6p01agh94gidiaesvev5saq6c6a30fmn.apps.googleusercontent.com" 
       data-context="signin"
       data-ux_mode="popup"
       data-callback="handleCallBack"
       data-auto_prompt="false">
    </div>
      
    <div class="g_id_signin"
       data-type="standard"
       data-shape="rectangular"
       data-theme="outline"
       data-text="signin_with"
       data-size="large"
       data-logo_alignment="left">
    </div>
    <script type="text/javascript">
    let googleSignOutComplete = new EventTarget();
    let googleSignIn = new EventTarget();
    
    let elm = document.createElement('div');
    document.body.appendChild(elm);
    
    let app = Elm.Main.init({
        node: elm,
        flags: googleSignOutComplete
    });
    
    app.ports.googleSignOut.subscribe(clientId => {
      ElmGoogleSignIn.signOut({
        port: app.ports.googleSignOutComplete,
        clientId: clientId,
        })
    });
    
    
    window.handleCallBack = (data) => {
      console.log(data)
      console.log(app.ports)
      app.ports.send(data)
    }
    
    </script>
  </body>
</html>